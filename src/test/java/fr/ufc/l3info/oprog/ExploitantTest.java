package fr.ufc.l3info.oprog;

import org.junit.Assert;
import org.junit.Before;
import org.junit.Test;

import java.io.File;
import java.io.IOException;

public class ExploitantTest {

    Exploitant ex;
    Ville v;

    @Before
    public void before() throws IOException {
        this.ex = new Exploitant();
        v = new Ville();
        v.initialiser(new File("./target/classes/data/OK1.txt"));
    }

    @Test
    public void acquerrirVeloNull() {
        this.ex.acquerirVelo(null);
        this.ex.ravitailler(v);
        Assert.assertNotNull(v.getStation("Gare Viotte"));
        Assert.assertEquals(10, v.getStation("Gare Viotte").nbBornesLibres());
    }

    @Test
    public void acquerrirVelo() {
        this.ex.acquerirVelo(new Velo());
        this.ex.acquerirVelo(new Velo());
        this.ex.ravitailler(v);
        Assert.assertNotNull(v.getStation("Gare Viotte"));
        Assert.assertEquals(8, v.getStation("Gare Viotte").nbBornesLibres());
    }

    @Test
    public void entretenirVelo() {
        IVelo v1= new Velo();
        v1.abimer();
        IVelo v2= new Velo();
        v2.parcourir(501);
        this.ex.acquerirVelo(v1);
        this.ex.acquerirVelo(v2);
        this.ex.entretenirVelos();
        this.ex.ravitailler(v);
        Assert.assertNotNull(v.getStation("Gare Viotte"));
        Assert.assertEquals(8, v.getStation("Gare Viotte").nbBornesLibres());
    }

    @Test
    public void ravitaillerVeloPlusieursStations() {
        for (int i=0 ; i<15; ++i) {
            IVelo v= new Velo();
            this.ex.acquerirVelo(v);
        }
        this.ex.ravitailler(v);
        Assert.assertNotNull(v.getStation("Gare Viotte"));
        Assert.assertEquals(5, v.getStation("Gare Viotte").nbBornesLibres());
        Assert.assertEquals(6, v.getStation("Saint Jacques").nbBornesLibres());
        Assert.assertEquals(6, v.getStation("Granvelle").nbBornesLibres());
        //Assert.assertEquals(6, v.getStation("Victor Hugo").nbBornesLibres());
    }
}
